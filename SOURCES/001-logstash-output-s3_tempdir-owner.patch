--- lib/logstash/outputs/s3.rb
+++ lib/logstash/outputs/s3.rb
@@ -63,7 +63,9 @@ require "socket" # for Socket.gethostname
 # This is an example of logstash config:
 
 # output {
-#    s3{ 
+#    s3{
+#      temp_directory                           (optional)
+#      s3_tempdir_owner                         (optional)
 #      access_key_id => "crazy_key"             (required)
 #      secret_access_key => "monkey_access_key" (required)
 #      endpoint_region => "eu-west-1"           (required)
@@ -111,6 +113,12 @@ class LogStash::Outputs::S3 < LogStash::Outputs::Base
  config_name "s3"
  milestone 1
 
+ # s3_tempdir
+ config :temp_directory, :validate => :string, :default => "/var/lib/logstash/S3_temp/"
+
+ # s3_tempdir_owner
+ config :s3_tempdir_owner, :validate => :string, :default => "logstash"
+
  # Aws access_key.
  config :access_key_id, :validate => :string
  
@@ -157,6 +165,8 @@ class LogStash::Outputs::S3 < LogStash::Outputs::Base
   @logger.info("Registering s3 output", :bucket => @bucket, :endpoint_region => @endpoint_region)
 
   AWS.config(
+    :s3_tempdir_owner => @s3_tempdir_owner,
+    :temp_directory => @temp_directory,
     :access_key_id => @access_key_id,
     :secret_access_key => @secret_access_key,
     :s3_endpoint => @endpoint_region
@@ -253,7 +263,7 @@ class LogStash::Outputs::S3 < LogStash::Outputs::Base
  public
  def register
    require "aws-sdk"
-   @temp_directory = "/opt/logstash/S3_temp/"
+   require "fileutils"
 
    if (@tags.size != 0)
        @tag_path = ""
@@ -263,10 +273,15 @@ class LogStash::Outputs::S3 < LogStash::Outputs::Base
    end
 
    if !(File.directory? @temp_directory)
-    @logger.debug "S3: Directory "+@temp_directory+" doesn't exist, let's make it!"
-    Dir.mkdir(@temp_directory)
+     @logger.info "S3: Directory "+@temp_directory+" doesn't exist, let's make it!"
+      unless Process.euid == 0
+        unless Dir.exists?("#{@temp_directory}")
+          Dir.mkdir(@temp_directory)
+          # FileUtils.chown("#{@s3_tempdir_owner}", "#{@s3_tempdir_owner}", "#{@temp_directory}")
+        end
+      end
    else
-    @logger.debug "S3: Directory "+@temp_directory+" exist, nothing to do"
+    @logger.info "S3: Directory "+@temp_directory+" exist, nothing to do"
    end 
    
    if (@restore == true )
